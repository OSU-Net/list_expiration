<!DOCTYPE html>
<html>
    <head>
    	
    	{% load staticfiles %}

	    <!-- list_extras provides several custom date formatting functions -->
	    {% load list_extras %}
	    
	    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	    <script src="{% static 'js/crsf.js' %}"></script>

	    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.css" />
	    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>

	    <link href="{% static 'css/index.css' %}"
        	rel="stylesheet" type="text/css"/>

	    <script src="{% static 'js/email_list.js' %}"
	        language="javascript"></script>
	        
	    <script src="{% static 'js/email_lists.js' %}"
	        language="javascript"></script>
    </head>
    <body>
        <div id="accordion">
            {% for listEntry in lists %}
            <h{{listEntry.id}}> {{listEntry.name}} </h{{listEntry.id}}>
            <div name="list_div" id="{{listEntry.id}}" class="list_entry">
            
                <div name="list_name" id="list_name_{{listEntry.id}}" class="list_field">
                    <p><b>List Name:</b></p>
                    <p>{{listEntry.name}}</p>
                </div>

                <div name="expire_date" id="expire_date_{{listEntry.id}}" class="list_field">
                    <p><b>List Expiration Date:</b></p>
                    <p>{{listEntry|format_expire_date}}</p>
                </div>

                <form name="edit_form" id="edit_form_{{listEntry.id}}" method="post" action="/lists/list_edit/"> {% csrf_token %}
                    <input type="hidden" name="list_id" value="{{listEntry.id}}">
                    <input type="text" name="expire_date" value="">    
                </form>

                <button name="edit_button" id="edit_button_{{listEntry.id}}" class="edit_button">Edit</button>
                <button name="cancel_button" id="cancel_button_{{listEntry.id}}" class="cancel_button">Cancel</button>
                <button name="forward_button" id="forward_button_{{listEntry.id}}" class="forward_button">Set foward two years</button> 
            </div>
            {% endfor %}

            <button id='accordion' name='logout_button'>Logout</button>
            <script>
            	$(function()
        		{
        			$('button[name=logout_button]').click(function()
    				{
						window.location.replace("{% url 'cas_logout' %}");
    				});
        		});
            </script>

        </div>
    </body>

    <script language="javascript">
        var list_array = new Array();
        {% for listEntry in lists %}

            list_array.push(new EmailList(
                {{ listEntry.id }},
                "{{ listEntry.name }}",
                "{{ listEntry|format_expire_date }}"
            ));
            
        {% endfor %}

        var email_lists = new EmailLists(list_array);
    </script>

    <script src="{% static 'js/index.js' %}"
        language="javascript"></script>

    <script>
        $(function()
        {
        	//$("#accordion").accordion();
        });
    </script>

</html>

